!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@trustarc/mention"),require("ngx-skeleton-loader"),require("lodash"),require("rxjs"),require("@angular/common/http"),require("@angular/forms"),require("@angular/router"),require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("@trustarc/ui-toolkit")):"function"==typeof define&&define.amd?define("veritas-ui-library",["exports","@trustarc/mention","ngx-skeleton-loader","lodash","rxjs","@angular/common/http","@angular/forms","@angular/router","rxjs/operators","@angular/common","@angular/core","@trustarc/ui-toolkit"],e):e(t["veritas-ui-library"]={},t.mention,t.ngxSkeletonLoader,t._,t.rxjs,t.ng.common.http,t.ng.forms,t.ng.router,t.rxjs.operators,t.ng.common,t.ng.core,t.uiToolkit)}(this,function(a,e,n,r,o,i,s,c,l,u,p,d){"use strict";var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function m(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function g(e,s,a,c){return new(a||(a=Promise))(function(t,n){function o(t){try{r(c.next(t))}catch(e){n(e)}}function i(t){try{r(c["throw"](t))}catch(e){n(e)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(o,i)}r((c=c.apply(e,s||[])).next())})}function y(o,i){var r,s,a,t,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function n(t){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,s&&(a=2&t[0]?s["return"]:t[0]?s["throw"]||((a=s["return"])&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,s=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(a=0<(a=c.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){c.label=t[1];break}if(6===t[0]&&c.label<a[1]){c.label=a[1],a=t;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(t);break}a[2]&&c.ops.pop(),c.trys.pop();continue}t=i.call(o,c)}catch(e){t=[6,e],s=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(o=r.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return s}function b(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function x(t,e){return e&&e.error&&e.error.message?t+" ("+e.error.message+")":t}function w(t){return t&&t.previousValue!==t.currentValue}function C(t,e){return Math.round(t/e*100)}var t,S,q,T,k,I,D,F,E,M=function(){function t(){this.splitKey=" "}return t.prototype.ngOnInit=function(){},t.prototype.ngOnChanges=function(t){w(t.name)&&this.setInitial()},t.prototype.setInitial=function(){var t=this.name.split(this.splitKey);this.initial=1<t.length?this.getInitial(t):this.name},t.prototype.getInitial=function(t){return""+this.getWordByIndex(t,0)+this.getWordByIndex(t,1)},t.prototype.getWordByIndex=function(t,e){return t[e][0].toLocaleUpperCase()},t.decorators=[{type:p.Component,args:[{selector:"ta-initial-indicator",template:'<div class="circle-indicator d-flex align-items-center justify-content-center">\r\n  {{ initial }}\r\n</div>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host{display:flex}:host .circle-indicator{height:24px;width:24px;border-radius:50%;border:1px solid #ffddd5;background-color:#ffeeea;color:#99331c;font-size:.625rem;font-weight:600}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={name:[{type:p.Input}]},t}(),A=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[M],imports:[u.CommonModule],exports:[M]}]}],t}(),R="VERITAS_API_PROXY_PREFIX_URL",O=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return decodeURIComponent(t)},t.prototype.decodeValue=function(t){return decodeURIComponent(t)},t}(),P=function(){function t(t,e){this.httpClient=t,this.veritasApiProxyPrefixUrl=e,this.url=this.veritasApiProxyPrefixUrl+"/users",this.maxRows=10}return t.prototype.getUsers$=function(t,e){void 0===e&&(e=null);var n=new i.HttpParams({encoder:new O}).append("page",t.toString()).append("size",this.maxRows.toString());return e&&(n=n.append("search",e)),this.httpClient.get(this.url,{params:n})},t.decorators=[{type:p.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:i.HttpClient},{type:String,decorators:[{type:p.Inject,args:[R]}]}]},t.ngInjectableDef=p.defineInjectable({factory:function(){return new t(p.inject(i.HttpClient),p.inject("VERITAS_API_PROXY_PREFIX_URL"))},token:t,providedIn:"root"}),t}(),B=function(){function t(t,e){this.formBuilder=t,this.userControllerService=e,this.commentPlaceholder="",this.canHideActions=!1,this.formSubmitted=new p.EventEmitter,this.formCancelled=new p.EventEmitter,this.commentForm=this.formBuilder.group({comment:["",s.Validators.required]}),this.MENTION_CONFIG={triggerChar:"@",maxItems:10,labelKey:"externalUserEmail",mentionSelect:this.onMentionSelect.bind(this)},this.mentionUsers=[],this.focused=!1}return t.prototype.ngOnInit=function(){this.commentPlaceholder&&this.commentForm.patchValue({comment:this.commentPlaceholder})},t.prototype.onSubmit=function(){this.formSubmitted.emit(this.commentForm.value)},t.prototype.onCancel=function(t){this.formCancelled.emit()},t.prototype.textFocus=function(){this.focused=!0},t.prototype.textFocusout=function(){},t.prototype.searchTerm=function(n){return g(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,this.userControllerService.getUsers$(0,n).toPromise()];case 1:return e=t.sent(),this.mentionUsers=e.content,[2]}})})},t.prototype.resetForm=function(){this.commentForm.reset()},t.prototype.onMentionSelect=function(t){return"[~"+t.externalUserEmail+"]"},t.decorators=[{type:p.Component,args:[{selector:"ta-comment-form",template:'<form [formGroup]="commentForm" (ngSubmit)="onSubmit()">\r\n  <textarea\r\n    class="mb-2"\r\n    rows="2"\r\n    formControlName="comment"\r\n    (focus)="textFocus()"\r\n    (focusout)="textFocusout()"\r\n  ></textarea>\r\n  <div\r\n    class="comment-footer d-flex justify-content-end"\r\n    *ngIf="focused || !canHideActions || commentForm.valid"\r\n  >\r\n    <button\r\n      type="button"\r\n      taButton\r\n      taType="flat"\r\n      class="btn-sm"\r\n      (click)="onCancel($event)"\r\n    >\r\n      Cancel\r\n    </button>\r\n    <button\r\n      [disabled]="!commentForm.valid"\r\n      taButton\r\n      taType="primary"\r\n      class="btn-sm"\r\n      type="submit"\r\n    >\r\n      Comment\r\n    </button>\r\n  </div>\r\n</form>\r\n',styles:[":host textarea{width:100%;border:1px solid #c2c2c2;border-radius:4px;resize:none;padding:8px}:host .btn{min-width:0}"]}]}],t.ctorParameters=function(){return[{type:s.FormBuilder},{type:P}]},t.propDecorators={commentPlaceholder:[{type:p.Input}],canHideActions:[{type:p.Input}],formSubmitted:[{type:p.Output}],formCancelled:[{type:p.Output}]},t}();(t=a.CommentEntityTypeEnum||(a.CommentEntityTypeEnum={})).Question="QUESTION",t.Task="TASK",(S=a.TaskStatusEnum||(a.TaskStatusEnum={})).Open="OPEN",S.InProgress="IN_PROGRESS",S.InReview="IN_REVIEW",S.Closed="CLOSED",S.ActionRequired="ACTION_REQUIRED",(q=a.TaskStatusEnum||(a.TaskStatusEnum={})).getDisplayText=function St(t){var e="";switch(t){case q.Open:e="Open";break;case q.InProgress:e="In Progress";break;case q.InReview:e="In Review";break;case q.Closed:e="Closed";break;case q.ActionRequired:e="Action Required"}return e},(T=a.RespondentTypeEnum||(a.RespondentTypeEnum={})).Reviewer="REVIEWER",T.RemediationTaskReviewer="REMEDIATION_TASK_REVIEWER",T.PrivacyTeam="PRIVACY_TEAM",T.BusinessOwner="BUSINESS_OWNER",T.VendorContact="VENDOR_CONTACT",T.HumanResourcesTeam="HUMAN_RESOURCES_TEAM",T.ItSecurityTeam="IT_SECURITY_TEAM",T.Other="OTHER",(k=a.RespondentTypeEnum||(a.RespondentTypeEnum={})).getDisplayText=function qt(t){var e="";switch(t){case k.Reviewer:e="Reviewer";break;case k.RemediationTaskReviewer:e="Remediation Task Reviewer";break;case k.PrivacyTeam:e="Privacy Team";break;case k.BusinessOwner:e="Business Owner";break;case k.VendorContact:e="Vendor Contact";break;case k.HumanResourcesTeam:e="Human Resources Team";break;case k.ItSecurityTeam:e="IT/Security Team";break;case k.Other:e="Other";break;default:e=t}return e},(I=a.QuestionTypeEnum||(a.QuestionTypeEnum={})).SingleSelect="SINGLE_SELECT",I.MultiSelect="MULTI_SELECT",I.Text="TEXT",(D=a.QuestionSingleSelectUiTypeEnum||(a.QuestionSingleSelectUiTypeEnum={})).Horizontal="HORIZONTAL",D.Vertical="VERTICAL",D.Slider="SLIDER",(F=a.QuestionMultiSelectUiTypeEnum||(a.QuestionMultiSelectUiTypeEnum={})).Horizontal="HORIZONTAL",F.Vertical="VERTICAL",(E=a.QuestionnaireViewModeEnum||(a.QuestionnaireViewModeEnum={})).All="all",E.Answered="answered",E.Unanswered="unanswered";var V=function(){function t(){this.fullName=""}return Object.defineProperty(t.prototype,"setFullName",{set:function(t){this.fullName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getFullName",{get:function(){return this.fullName},enumerable:!0,configurable:!0}),t.decorators=[{type:p.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=p.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),U=function(){function t(t,e){this.httpClient=t,this.veritasApiProxyPrefixUrl=e,this.url=this.veritasApiProxyPrefixUrl+"/comment"}return t.prototype.getComments$=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=20);var o=(new i.HttpParams).append("page",(e+-1).toString()).append("size",n.toString());return this.httpClient.get(this.url+"/"+t,{params:o}).pipe(l.map(function(t){return t.content.forEach(function(t){t.isEditing=!1}),t}))},t.prototype.createComment$=function(t,e,n){var o={entityId:t,entityType:e,messageText:n};return this.httpClient.post(this.url+"/"+t,o)},t.prototype.updateComment$=function(t,e,n,o){var i={entityId:t,entityType:e,messageText:o,id:n};return this.httpClient.post(this.url+"/"+t+"/"+n,i)},t.prototype.deleteComment$=function(t,e){return this.httpClient["delete"](this.url+"/"+t+"/"+e)},t.prototype.getQuestionContainerViewPages=function(t){return this.httpClient.get("/api/question-survey/"+t).pipe(l.map(this.mapGetQuestionContainerViewPages))},t.prototype.getAttachmentDownloadUrl$=function(t){return this.httpClient.get(this.url+"/attachments/"+t+"/url")},t.prototype.mapGetQuestionContainerViewPages=function(t){return t},t.prototype.postQuestionDetailResponses=function(t,e,n){var o={answers:t,submitAction:e};return this.httpClient.post("/api/question-survey/"+n,o)},t.decorators=[{type:p.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:i.HttpClient},{type:String,decorators:[{type:p.Inject,args:[R]}]}]},t.ngInjectableDef=p.defineInjectable({factory:function(){return new t(p.inject(i.HttpClient),p.inject("VERITAS_API_PROXY_PREFIX_URL"))},token:t,providedIn:"root"}),t}(),Q=function(){function t(t,e){this.dashBoardCommentControllerService=t,this.aaaUserService=e,this.apiComments=null,this.isLoading=!1,this.isRefreshing=!1,this.searchUser$=new o.BehaviorSubject("")}return t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){this._searchUser$&&this._searchUser$.unsubscribe()},t.prototype.popoverShown=function(){return g(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.apiComments?this.isRefreshing=!0:this.isLoading=!0,[4,this.loadComments()];case 1:return t.sent(),this.isLoading=!1,this.isRefreshing=!1,[2]}})})},t.prototype.searchTerm=function(t){this.searchUser$.next(t)},t.prototype.toggleEdit=function(t){t.isEditing=!t.isEditing},t.prototype.onSubmit=function(t){t&&this.createComment(t.comment)},t.prototype.updateSubmit=function(e,n){return g(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.isRefreshing=!0,[4,this.updateComment(n.id,e.comment)];case 1:return t.sent(),[4,this.loadComments()];case 2:return t.sent(),this.isRefreshing=!1,[2]}})})},t.prototype.createComment=function(e){return g(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.isRefreshing=!0,[4,this.dashBoardCommentControllerService.createComment$(this.entityId,a.CommentEntityTypeEnum.Question,e).toPromise()];case 1:return t.sent(),[4,this.loadComments()];case 2:return t.sent(),this.newCommentForm.resetForm(),this.isRefreshing=!1,[2]}})})},t.prototype.updateComment=function(e,n){return g(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.dashBoardCommentControllerService.updateComment$(this.entityId,a.CommentEntityTypeEnum.Question,e,n).toPromise()];case 1:return t.sent(),[2]}})})},t.prototype.deleteComment=function(e){return g(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.isRefreshing=!0,[4,this.dashBoardCommentControllerService.deleteComment$(this.entityId,e).toPromise()];case 1:return t.sent(),[4,this.loadComments()];case 2:return t.sent(),this.isRefreshing=!1,[2]}})})},t.prototype.loadComments=function(){return g(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,this.dashBoardCommentControllerService.getComments$(this.entityId).toPromise()];case 1:return e=t.sent(),this.apiComments=e,[2]}})})},t.decorators=[{type:p.Component,args:[{selector:"ta-comments-popover",template:'<button\r\n  class="mr-2"\r\n  taButton\r\n  taType="circle"\r\n  [taPopover]="popContent"\r\n  placement="bottom-right"\r\n  [autoClose]="\'outside\'"\r\n  #popover="taPopover"\r\n  (shown)="popoverShown()"\r\n>\r\n  <ta-icon icon="edit"></ta-icon>\r\n</button>\r\n\r\n<ng-template #popContent>\r\n  <div class="comment-popover-template">\r\n    <div class="loading-overlay" *ngIf="isRefreshing && !isLoading"></div>\r\n    <ng-container *ngIf="isLoading">\r\n      <div class="mb-2">\r\n        <ngx-skeleton-loader count="1" appearance="line"></ngx-skeleton-loader>\r\n      </div>\r\n      <div class="mb-2">\r\n        <ngx-skeleton-loader\r\n          count="1"\r\n          appearance="line"\r\n          [theme]="{ height: \'50px\' }"\r\n        ></ngx-skeleton-loader>\r\n      </div>\r\n      <div class="row">\r\n        <div class="col-6"></div>\r\n        <div class="col-6">\r\n          <ngx-skeleton-loader\r\n            count="1"\r\n            appearance="line"\r\n          ></ngx-skeleton-loader>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n    <ng-container *ngIf="!isLoading">\r\n      <div\r\n        *ngFor="\r\n          let comment of apiComments.content.slice().reverse();\r\n          let i = index\r\n        "\r\n        class="comment pb-3"\r\n      >\r\n        <div class="comment-header d-flex">\r\n          <div class="d-inline-block">\r\n            <ta-initial-indicator\r\n              [name]="comment.createdByFullName"\r\n            ></ta-initial-indicator>\r\n          </div>\r\n          <div class="flex-grow-1 d-flex align-items-center">\r\n            <div class="d-flex flex-column ml-2">\r\n              <h3 class="overflow-ellipsis" [ngClass]="{ narrow: i === 0 }">\r\n                {{ comment.createdByFullName }}\r\n              </h3>\r\n              <span>{{ comment.created | date: \'MMM d, h:mm a\' }}</span>\r\n            </div>\r\n          </div>\r\n          <div *ngIf="i === 0" class="mr-2">\r\n            <button taButton taType="primary" class="btn-sm">\r\n              Resolve\r\n            </button>\r\n          </div>\r\n          <div taDropdown container="body" placement="bottom-right">\r\n            <button\r\n              taButton\r\n              taType="circle"\r\n              id="dropdownBasic1"\r\n              taDropdownToggle\r\n            >\r\n              <ta-icon icon="more"></ta-icon>\r\n            </button>\r\n            <div\r\n              taDropdownMenu\r\n              aria-labelledby="dropdownBasic1"\r\n              class="actions-dropdown"\r\n            >\r\n              <button class="dropdown-item" (click)="toggleEdit(comment)">\r\n                Edit\r\n              </button>\r\n              <button class="dropdown-item" (click)="deleteComment(comment.id)">\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <p *ngIf="!comment.isEditing" class="mb-0">{{ comment.messageText }}</p>\r\n        <div [hidden]="!comment.isEditing">\r\n          <ta-comment-form\r\n            (formCancelled)="toggleEdit(comment)"\r\n            (formSubmitted)="updateSubmit($event, comment)"\r\n            [commentPlaceholder]="comment.messageText"\r\n          ></ta-comment-form>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class="comment-header d-flex"\r\n        *ngIf="apiComments?.content?.length === 0"\r\n      >\r\n        <div class="d-inline-block">\r\n          <ta-initial-indicator\r\n            [name]="aaaUserService.getFullName"\r\n          ></ta-initial-indicator>\r\n        </div>\r\n        <div class="flex-grow-1 d-flex align-items-center">\r\n          <div class="d-flex flex-column ml-2 mr-2">\r\n            <h3 class="overflow-ellipsis">\r\n              {{ aaaUserService.getFullName }}\r\n            </h3>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ta-comment-form\r\n        #newCommentForm\r\n        (formCancelled)="popover.close()"\r\n        (formSubmitted)="onSubmit($event)"\r\n        [canHideActions]="apiComments?.content?.length > 0"\r\n      ></ta-comment-form>\r\n    </ng-container>\r\n  </div>\r\n</ng-template>\r\n',styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}.comment-popover-template{width:242px}.comment-popover-template .loading-overlay{background-color:#fff;opacity:.6;z-index:10;position:absolute;left:0;top:0;width:100%;height:100%}.comment-popover-template .comment{border-bottom:1px solid #f3f3f3;margin-bottom:16px}.comment-popover-template .comment-header{margin-bottom:8px}.comment-popover-template .comment-header .actions-dropdown{min-width:0}.comment-popover-template .comment-header h3{width:170px;font-size:12px;margin-bottom:0}.comment-popover-template .comment-header h3.narrow{width:110px}.comment-popover-template .comment-header span{color:#595959;font-size:10px}.comment-popover-template textarea{width:100%;border:1px solid #c2c2c2;border-radius:4px;resize:none;padding:8px}.comment-popover-template .btn{min-width:0}"]}]}],t.ctorParameters=function(){return[{type:U},{type:V}]},t.propDecorators={entityId:[{type:p.Input}],newCommentForm:[{type:p.ViewChild,args:["newCommentForm"]}]},t}(),j=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[Q,B],imports:[u.CommonModule,d.TaSvgIconModule,d.TaButtonsModule,d.TaPopoverModule,A,d.TaDropdownModule,d.TaCheckboxModule,s.FormsModule,s.ReactiveFormsModule,e.TaMentionModule,n.NgxSkeletonLoaderModule],exports:[Q]}]}],t}(),_=function(){function t(t){this.modalService=t,this.description="The item cannot be recovered once deleted. Are you sure you want to delete this?",this.primaryButtonText="Delete",this.secondaryButtonText="Secondary",this.cancelButtonText="Cancel",this.clickPrimary=new p.EventEmitter,this.clickSecondary=new p.EventEmitter,this.afterCancelled=new p.EventEmitter}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){return t.initDefaultFocus()})},t.prototype.onClickCancel=function(){this.modalService.dismiss("Cancel click"),this.afterCancelled.emit()},t.prototype.initDefaultFocus=function(){this.primaryButton.el.nativeElement.focus()},t.decorators=[{type:p.Component,args:[{selector:"ta-delete-modal",template:'<div\r\n  class="modal-body d-flex flex-column align-items-center justify-content-center"\r\n>\r\n  <div\r\n    class="delete-icon-container d-flex align-items-center justify-content-center"\r\n  >\r\n    <ta-icon class="delete-icon" icon="delete"></ta-icon>\r\n  </div>\r\n\r\n  <div class="title my-2">\r\n    {{ title }}\r\n  </div>\r\n\r\n  <div class="description">\r\n    {{ description }}\r\n  </div>\r\n</div>\r\n\r\n<div class="modal-footer align-items-start justify-content-start p-4">\r\n  <button\r\n    taButton\r\n    taType="flat"\r\n    class="cancel-button mr-auto btn-lg"\r\n    data-dismiss="modal"\r\n    (click)="onClickCancel()"\r\n  >\r\n    {{ cancelButtonText }}\r\n  </button>\r\n\r\n  <button\r\n    *ngIf="isSecondaryButtonEnabled"\r\n    taButton\r\n    taType="secondary"\r\n    class="secondary-button btn-lg btn-delete mr-3"\r\n    (click)="clickSecondary.emit()"\r\n  >\r\n    {{ secondaryButtonText }}\r\n  </button>\r\n\r\n  <button\r\n    #primaryButton\r\n    taButton\r\n    taType="danger"\r\n    class="primary-button btn-lg m-0"\r\n    (click)="clickPrimary.emit()"\r\n  >\r\n    {{ primaryButtonText }}\r\n  </button>\r\n</div>\r\n',encapsulation:p.ViewEncapsulation.None,changeDetection:p.ChangeDetectionStrategy.OnPush,styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}ta-delete-modal .modal-body .delete-icon-container{height:48px;width:48px;background-color:#fef5f5;border-radius:50%}ta-delete-modal .modal-body .delete-icon-container .ta-svg-icon-delete{color:#de2e21}ta-delete-modal .modal-body .delete-icon-container .ta-svg-icon-delete svg{height:20px;width:20px}ta-delete-modal .modal-body .title{font-size:1rem;font-weight:500}ta-delete-modal .modal-body .description{color:#595959}ta-delete-modal .modal-footer{border-top:none!important}ta-delete-modal .modal-footer .secondary-button{color:#000}"]}]}],t.ctorParameters=function(){return[{type:d.TaActiveModal}]},t.propDecorators={title:[{type:p.Input}],description:[{type:p.Input}],primaryButtonText:[{type:p.Input}],secondaryButtonText:[{type:p.Input}],cancelButtonText:[{type:p.Input}],isSecondaryButtonEnabled:[{type:p.Input}],clickPrimary:[{type:p.Output}],clickSecondary:[{type:p.Output}],afterCancelled:[{type:p.Output}],primaryButton:[{type:p.ViewChild,args:["primaryButton"]}]},t}(),z=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[_],imports:[u.CommonModule,d.TaButtonsModule,d.TaSvgIconModule,d.TaModalModule],exports:[_],entryComponents:[_]}]}],t}(),N=function(){function t(){this.dBlock=!0,this.attachments=[],this.files=[],this.deleteAttachment=new p.EventEmitter,this.clickAttachment=new p.EventEmitter,this.removeFile=new p.EventEmitter}return t.prototype.ngOnInit=function(){},t.decorators=[{type:p.Component,args:[{selector:"ta-file-download",template:'<div class="file-attachment-summary pb-1">\r\n  Attachments ({{ attachments?.length + files?.length }})\r\n</div>\r\n\r\n<ng-container *ngFor="let attachment of attachments">\r\n  <div class="d-flex justify-content-between mt-2">\r\n    <label\r\n      class="file-name-clickable text-truncate mr-1 mt-1 mb-0"\r\n      (click)="clickAttachment.emit(attachment)"\r\n      >{{ attachment[config.attachmentNameKey] }}</label\r\n    >\r\n    <div class="d-flex align-items-center">\r\n      <span\r\n        *ngIf="hasDescription"\r\n        class="file-description text-truncate mr-3"\r\n        [innerText]="attachment.fileDescription"\r\n      ></span>\r\n\r\n      <button\r\n        taButton\r\n        taType="circle"\r\n        taTooltip="Delete"\r\n        placement="top-right"\r\n        container="body"\r\n        class="flex-shrink-0"\r\n        [disabled]="disabled"\r\n        (click)="deleteAttachment.emit(attachment)"\r\n      >\r\n        <ta-icon icon="delete"></ta-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-container *ngFor="let file of files; let i = index">\r\n  <div class="d-flex justify-content-between mt-2">\r\n    <label class="file-name text-truncate mr-1 mt-1 mb-0">{{\r\n      file.file.name\r\n    }}</label>\r\n\r\n    <div class="d-flex align-items-center">\r\n      <input\r\n        *ngIf="hasDescription"\r\n        type="text"\r\n        class="file-description form-control mr-3"\r\n        placeholder="File description"\r\n        [disabled]="disabled"\r\n        [(ngModel)]="file.text"\r\n      />\r\n\r\n      <button\r\n        taButton\r\n        taType="circle"\r\n        taTooltip="Delete"\r\n        placement="top-right"\r\n        container="body"\r\n        class="flex-shrink-0"\r\n        [disabled]="disabled"\r\n        (click)="removeFile.emit(i)"\r\n      >\r\n        <ta-icon icon="delete"></ta-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</ng-container>\r\n\r\n<div class="no-files mt-2" *ngIf="attachments?.length + files?.length === 0">\r\n  No files attached.\r\n</div>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .file-name,:host .file-name-clickable{color:#0052cc}:host .file-name-clickable{cursor:pointer}:host .file-attachment-summary{font-size:.75rem;font-weight:500}:host .no-files{color:#595959}:host .file-description{width:230px}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={dBlock:[{type:p.HostBinding,args:["class.d-block"]}],attachments:[{type:p.Input}],files:[{type:p.Input}],disabled:[{type:p.Input}],hasDescription:[{type:p.Input}],config:[{type:p.Input}],deleteAttachment:[{type:p.Output}],clickAttachment:[{type:p.Output}],removeFile:[{type:p.Output}]},t}(),$=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[N],imports:[u.CommonModule,s.FormsModule,d.TaButtonsModule,d.TaSvgIconModule],exports:[N]}]}],t}(),L=function(){function t(t){this.changeDetectorRef=t}return Object.defineProperty(t.prototype,"isChangeDetectorDestroyed",{get:function(){return this.changeDetectorRef.destroyed},enumerable:!0,configurable:!0}),t.prototype.markForCheck=function(){this.isChangeDetectorDestroyed||this.changeDetectorRef.markForCheck()},t.prototype.detach=function(){this.isChangeDetectorDestroyed||this.changeDetectorRef.detach()},t.prototype.detectChanges=function(){this.isChangeDetectorDestroyed||this.changeDetectorRef.detectChanges()},t.prototype.checkNoChanges=function(){this.isChangeDetectorDestroyed||this.changeDetectorRef.checkNoChanges()},t.prototype.reattach=function(){this.isChangeDetectorDestroyed||this.changeDetectorRef.reattach()},t}(),H={jpg:{exts:["jpg","jpeg"],mime:["image/jpeg","image/jpg","image/jp_","application/jpg","application/x-jpg","image/pjpeg","image/pipeg","image/vnd.swiftview-jpeg","image/x-xbitmap"]},png:{exts:["png"],mime:["image/png","application/png","application/x-png"]},gif:{exts:["gif"],mime:["image/gif","image/x-xbitmap","image/gi_"]},csv:{exts:["csv"],mime:["text/comma-separated-values","text/csv","application/csv","application/excel","application/vnd.ms-excel","application/vnd.msexcel","text/anytext"]},tsv:{exts:["tsv"],mime:["text/tab-separated-values"]},zip:{exts:["zip"],mime:["application/zip","application/x-zip","application/x-zip-compressed","application/octet-stream","application/x-compress","application/x-compressed","multipart/x-zip"]},txt:{exts:["txt"],mime:["text/plain","application/txt","browser/internal","text/anytext","widetext/plain","widetext/paragraph"]},doc:{exts:["doc","docx"],mime:["application/msword [official]","application/doc","application/vnd.msword","application/vnd.ms-word","application/winword","application/word","application/x-msw6","application/x-msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]},xsl:{exts:["xsl","xlsx"],mime:["application/vnd.ms-excel [official]","application/msexcel","application/x-msexcel","application/x-ms-excel","application/vnd.ms-excel","application/x-excel","application/x-dos_ms_excel","application/xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]},ppt:{exts:["ppt","pptx"],mime:["application/vnd.ms-powerpoint [official]","application/mspowerpoint","application/ms-powerpoint","application/mspowerpnt","application/vnd-mspowerpoint","application/powerpoint","application/x-powerpoint","application/x-m"]},rtf:{exts:["rtf"],mime:["application/rtf","application/x-rtf","text/rtf","text/richtext","application/msword","application/doc","application/x-soffice"]},pdf:{exts:["pdf"],mime:["application/pdf","application/x-pdf","application/acrobat","applications/vnd.pdf","text/pdf","text/x-pdf"]},css:{exts:["css"],mime:["text/css","application/css-stylesheet"]},js:{exts:["js"],mime:["application/x-javascript","text/javascript"]},html:{exts:["html"],mime:["text/html","text/plain"]},code:{exts:["php","ts"],mime:[]}},W=function(){function t(){this.format=H}return t.prototype.isValidFileSize=function(t,e){return t<=e},t.prototype.isValidExtension=function(t,e){return e.jpg&&this.isJpgFile(t)||e.png&&this.isPngFile(t)||e.gif&&this.isGifFile(t)||e.csv&&this.isCsvFile(t)||e.tsv&&this.isTsvFile(t)||e.zip&&this.isZipFile(t)||e.txt&&this.isTxtFile(t)||e.doc&&this.isDocFile(t)||e.xsl&&this.isXslFile(t)||e.ppt&&this.isPptFile(t)||e.rtf&&this.isRtfFile(t)||e.pdf&&this.isPdfFile(t)||e.css&&this.isCssFile(t)||e.js&&this.isJsFile(t)||e.html&&this.isHtmlFile(t)||e.code&&this.isCodeFile(t)},t.prototype.getAllowedMime=function(t){var e=[];for(var n in t)this.format[n]&&e.push(this.format[n].mime);return r.union(e)},t.prototype.checkFileWith=function(t,e,n){var o=n.name.split(".").pop().toLowerCase(),i=(""===n.type||0===t.length)&&e.includes(o),r=n.type&&t.includes(n.type);return i||r},t.prototype.isJpgFile=function(t){return this.checkFileWith(this.format.jpg.mime,this.format.jpg.exts,t)},t.prototype.isPngFile=function(t){return this.checkFileWith(this.format.png.mime,this.format.png.exts,t)},t.prototype.isGifFile=function(t){return this.checkFileWith(this.format.gif.mime,this.format.gif.exts,t)},t.prototype.isCsvFile=function(t){return this.checkFileWith(this.format.csv.mime,this.format.csv.exts,t)},t.prototype.isTsvFile=function(t){return this.checkFileWith(this.format.tsv.mime,this.format.tsv.exts,t)},t.prototype.isZipFile=function(t){return this.checkFileWith(this.format.zip.mime,this.format.zip.exts,t)},t.prototype.isTxtFile=function(t){return this.checkFileWith(this.format.txt.mime,this.format.txt.exts,t)},t.prototype.isDocFile=function(t){return this.checkFileWith(this.format.doc.mime,this.format.doc.exts,t)},t.prototype.isXslFile=function(t){return this.checkFileWith(this.format.xsl.mime,this.format.xsl.exts,t)},t.prototype.isPptFile=function(t){return this.checkFileWith(this.format.ppt.mime,this.format.ppt.exts,t)},t.prototype.isRtfFile=function(t){return this.checkFileWith(this.format.rtf.mime,this.format.rtf.exts,t)},t.prototype.isPdfFile=function(t){return this.checkFileWith(this.format.pdf.mime,this.format.pdf.exts,t)},t.prototype.isCssFile=function(t){return this.checkFileWith(this.format.css.mime,this.format.css.exts,t)},t.prototype.isJsFile=function(t){return this.checkFileWith(this.format.js.mime,this.format.js.exts,t)},t.prototype.isHtmlFile=function(t){return this.checkFileWith(this.format.html.mime,this.format.html.exts,t)},t.prototype.isCodeFile=function(t){return this.checkFileWith(this.format.code.mime,this.format.code.exts,t)},t.decorators=[{type:p.Injectable}],t.ctorParameters=function(){return[]},t}(),G=function(i){function t(t,e,n){var o=i.call(this,t)||this;return o.changeDetectorRef=t,o.fileUploadValidationService=e,o.toastService=n,o.formatConfig={jpg:!1,png:!1,gif:!1,csv:!1,tsv:!1,zip:!1,txt:!1,doc:!1,xsl:!1,ppt:!1,rtf:!1,pdf:!1,css:!1,js:!1,html:!1,code:!1},o.afterFilesSelected=new p.EventEmitter,o.draggingOver=!1,o.allowedMime=[],o.files=[],o.propagateChange=function(t){},o}return m(t,i),t.prototype.ngOnInit=function(){this.allowedMime=this.fileUploadValidationService.getAllowedMime(this.formatConfig)},t.prototype.onDragOver=function(t){t.preventDefault(),this.draggingOver=!0,this.markForCheck()},t.prototype.onDragLeave=function(t){t.preventDefault(),this.draggingOver=!1,this.markForCheck()},t.prototype.selectFiles=function(t){var n=this,e=Object.assign([],t),o=!0;this.isValidFilesSize(e)||(o=!1,this.toastService.error("Attachments size exceeds the allowable limit (maximum: "+this.formatBytes(this.maxFileSize)+")")),e.forEach(function(t,e){n.fileUploadValidationService.isValidExtension(t,n.formatConfig)||(o=!1,n.toastService.error(t.name+" is invalid file type"))}),o&&(this.propagateChange(e),this.markForCheck(),this.afterFilesSelected.emit(e))},t.prototype.onDrop=function(t){t.preventDefault(),this.onDragLeave(t),this.selectFiles(t.dataTransfer.files)},t.prototype.onFilesSelected=function(t){this.selectFiles(t.target.files),t.target.value=null},t.prototype.openUploadBrowser=function(){this.fileInput.nativeElement.click()},t.prototype.registerOnChange=function(t){this.propagateChange=t},t.prototype.registerOnTouched=function(){},t.prototype.writeValue=function(t){t&&(this.files=t)},t.prototype.formatBytes=function(t,e){if(void 0===e&&(e=2),0===t)return"0 Bytes";var n=e<0?0:e,o=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,o)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]},t.prototype.isValidFilesSize=function(t){var e=this.getFilesSize(t);return!this.maxFileSize||this.fileUploadValidationService.isValidFileSize(e,this.maxFileSize)},t.prototype.getFilesSize=function(t){return t.map(function(t){return t.size}).reduce(function(t,e){return t+e})},t.decorators=[{type:p.Component,args:[{selector:"ta-file-upload",template:'<div\r\n  class="file-upload-container drop-zone p-3"\r\n  [ngClass]="{ \'dragging-over\': draggingOver }"\r\n  (dragover)="onDragOver($event)"\r\n  (dragleave)="onDragLeave($event)"\r\n  (drop)="onDrop($event)"\r\n  (click)="$event.stopPropagation()"\r\n>\r\n  {{ prefixText }}\r\n  <label [attr.for]="id + \'-input\'" class="m-0">{{ linkText }}</label>\r\n  {{ suffixText }}\r\n  <input\r\n    #fileInput\r\n    type="file"\r\n    [attr.id]="id + \'-input\'"\r\n    [multiple]="isMultiple"\r\n    [accept]="allowedMime"\r\n    (change)="onFilesSelected($event)"\r\n  />\r\n</div>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,providers:[{provide:s.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return t}),multi:!0}],styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .file-upload-container{border:2px dashed #c2c2c2;border-radius:4px;text-align:center;background:#fff}:host .file-upload-container.dragging-over{background:#ccf0f8;border:2px dashed rgba(0,0,0,.3)}:host .file-upload-container label{cursor:pointer;color:#0052cc}:host .file-upload-container input[type=file]{display:none}"]}]}],t.ctorParameters=function(){return[{type:p.ChangeDetectorRef},{type:W},{type:d.ToastService}]},t.propDecorators={id:[{type:p.Input}],prefixText:[{type:p.Input}],linkText:[{type:p.Input}],suffixText:[{type:p.Input}],isMultiple:[{type:p.Input}],formatConfig:[{type:p.Input}],maxFileSize:[{type:p.Input}],afterFilesSelected:[{type:p.Output}],fileInput:[{type:p.ViewChild,args:["fileInput"]}]},t}(L),X=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[G],imports:[u.CommonModule,d.TaButtonsModule,d.TaSvgIconModule,d.TaTooltipModule],exports:[G],providers:[W]}]}],t}(),K=function(n){function t(t){var e=n.call(this,t)||this;return e.changeDetectorRef=t,e.prefixText="Drag & drop your files to attach or",e.linkText="browse",e.suffixText="to choose a file",e.attachments=[],e.files=[],e.config={attachmentNameKey:"originalFileName",format:{pdf:!0,doc:!0}},e.isMultiple=!0,e.maxFileSize=1048321,e.afterFilesSelected=new p.EventEmitter,e.deleteAttachment=new p.EventEmitter,e.clickAttachment=new p.EventEmitter,e}return m(t,n),t.prototype.onAfterFilesSelected=function(t,e){var n=t.map(function(t){return{file:t,text:e}});this.files=b(this.files,n),this.afterFilesSelected.emit(this.files),this.detectChanges()},t.prototype.onRemoveFile=function(t){this.files.splice(t,1),this.afterFilesSelected.emit(this.files),this.detectChanges()},t.prototype.onClickAttachment=function(t){this.clickAttachment.emit(t)},t.prototype.onDeleteAttachment=function(t){this.deleteAttachment.emit(t)},t.prototype.writeValue=function(t){t&&(this.files=t)},t.prototype.registerOnChange=function(){},t.prototype.registerOnTouched=function(){},t.decorators=[{type:p.Component,args:[{selector:"ta-simple-file-upload",template:'<ta-file-upload\r\n  class="d-block"\r\n  [ngClass]="{\r\n    hidden: uploadHidden,\r\n    \'mb-3\': !uploadHidden\r\n  }"\r\n  [id]="id + \'-file-upload\'"\r\n  [prefixText]="prefixText"\r\n  [linkText]="linkText"\r\n  [suffixText]="suffixText"\r\n  [isMultiple]="isMultiple"\r\n  [formatConfig]="config.format"\r\n  [maxFileSize]="maxFileSize"\r\n  (afterFilesSelected)="onAfterFilesSelected($event)"\r\n></ta-file-upload>\r\n\r\n<ta-file-download\r\n  class="ml-1"\r\n  [attachments]="attachments"\r\n  [files]="files"\r\n  [disabled]="disabled"\r\n  [hasDescription]="hasDescription"\r\n  [config]="config"\r\n  (clickAttachment)="onClickAttachment($event)"\r\n  (deleteAttachment)="onDeleteAttachment($event)"\r\n  (removeFile)="onRemoveFile($event)"\r\n></ta-file-download>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,providers:[{provide:s.NG_VALUE_ACCESSOR,useExisting:t,multi:!0}],styles:[":host ta-file-upload.hidden{visibility:hidden;height:0;margin:0}"]}]}],t.ctorParameters=function(){return[{type:p.ChangeDetectorRef}]},t.propDecorators={id:[{type:p.Input}],prefixText:[{type:p.Input}],linkText:[{type:p.Input}],suffixText:[{type:p.Input}],attachments:[{type:p.Input}],files:[{type:p.Input}],config:[{type:p.Input}],isMultiple:[{type:p.Input}],disabled:[{type:p.Input}],hasDescription:[{type:p.Input}],maxFileSize:[{type:p.Input}],uploadHidden:[{type:p.Input}],afterFilesSelected:[{type:p.Output}],deleteAttachment:[{type:p.Output}],clickAttachment:[{type:p.Output}],fileUploadComponent:[{type:p.ViewChild,args:[G]}]},t}(L),Y=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[K],imports:[u.CommonModule,X,s.FormsModule,s.ReactiveFormsModule,d.TaButtonsModule,d.TaSvgIconModule,d.TaTooltipModule,$],exports:[K]}]}],t}(),J=function Tt(){},Z=function kt(){},tt=function It(){},et=function(){function t(){this.questionMultiSelectUiTypeEnum=a.QuestionMultiSelectUiTypeEnum,this.onChange=function(t){}}return t.prototype.ngOnInit=function(){},t.prototype.onSelectResponse=function(t){this.onChange(t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(){},t.prototype.writeValue=function(t){},t.decorators=[{type:p.Component,args:[{selector:"ta-multi-select",template:'<div class="multi-select-placeholder mt-n3 mb-3">Select all that apply.</div>\r\n\r\n<div\r\n  class="d-flex"\r\n  [ngClass]="{\r\n    \'flex-column\':\r\n      question?.questionDetails?.multiSelectUiType ===\r\n      questionMultiSelectUiTypeEnum.Vertical,\r\n    \'flex-wrap\':\r\n      question?.questionDetails?.multiSelectUiType ===\r\n      questionMultiSelectUiTypeEnum.Horizontal\r\n  }"\r\n>\r\n  <div\r\n    *ngFor="let response of question?.questionDetails?.questionDetailResponses"\r\n    class="btn-group-toggle"\r\n    taRadioGroup\r\n  >\r\n    <label class="btn-primary mb-1" taButtonLabel>\r\n      <input\r\n        class="input-radio"\r\n        type="radio"\r\n        taButton\r\n        [value]="response"\r\n        (click)="onSelectResponse(response)"\r\n      />\r\n      {{ response.questionDetailResponsesChoice }}\r\n    </label>\r\n  </div>\r\n</div>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,providers:[{provide:s.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return t}),multi:!0}],styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .multi-select-placeholder{color:#595959}:host .input-radio{display:none}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={question:[{type:p.Input}]},t}(),nt=function(){function t(){this.questionSingleSelectUiTypeEnum=a.QuestionSingleSelectUiTypeEnum,this.onChange=function(t){}}return t.prototype.ngOnInit=function(){},t.prototype.ngOnChanges=function(t){w(t.question)&&this.updateStep()},t.prototype.onSelectResponse=function(t){this.onChange(t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(){},t.prototype.writeValue=function(t){},t.prototype.updateStep=function(){var t=100/(this.question.questionDetails.questionDetailResponses.length+1);this.step=+t.toFixed(2)},t.decorators=[{type:p.Component,args:[{selector:"ta-single-select",template:'<ng-container\r\n  *ngIf="\r\n    question?.questionDetails?.singleSelectUiType ===\r\n      questionSingleSelectUiTypeEnum.Slider;\r\n    else nonSliderSingleQuestion\r\n  "\r\n>\r\n  <div class="slider-placeholder mt-n3 mb-3">Select one</div>\r\n\r\n  <input\r\n    type="range"\r\n    value="50"\r\n    class="slider w-100"\r\n    min="0"\r\n    max="99"\r\n    [step]="step"\r\n  />\r\n\r\n  <div class="d-flex pb-2 mb-4">\r\n    <div [style.width]="step / 2 + \'%\'"></div>\r\n\r\n    <div\r\n      *ngFor="\r\n        let response of question?.questionDetails?.questionDetailResponses;\r\n        let i = index\r\n      "\r\n      class="slider-text text-center px-2"\r\n      [style.width]="step + \'%\'"\r\n    >\r\n      {{ response.questionDetailResponsesChoice }}\r\n    </div>\r\n\r\n    <div [style.width]="step / 2 + \'%\'"></div>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #nonSliderSingleQuestion>\r\n  <div\r\n    class="btn-group-toggle d-flex"\r\n    [ngClass]="{\r\n      \'flex-column\':\r\n        question?.questionDetails?.singleSelectUiType ===\r\n        questionSingleSelectUiTypeEnum.Vertical,\r\n      \'flex-wrap\':\r\n        question?.questionDetails?.singleSelectUiType ===\r\n        questionSingleSelectUiTypeEnum.Horizontal\r\n    }"\r\n    taRadioGroup\r\n    name="radioBasic"\r\n  >\r\n    <div\r\n      *ngFor="\r\n        let response of question?.questionDetails?.questionDetailResponses\r\n      "\r\n    >\r\n      <label class="btn-primary mb-1" taButtonLabel>\r\n        <input\r\n          class="input-radio"\r\n          type="radio"\r\n          taButton\r\n          [value]="response"\r\n          (click)="onSelectResponse(response)"\r\n        />\r\n        {{ response.questionDetailResponsesChoice }}\r\n      </label>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,providers:[{provide:s.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return t}),multi:!0}],styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .slider-placeholder{color:#595959}:host .input-radio{display:none}:host .slider-text{color:#595959}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={question:[{type:p.Input}]},t}(),ot=function(){function t(){this.onChange=function(t){}}return t.prototype.ngOnInit=function(){},t.prototype.onModelChange=function(t){this.onChange(t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(){},t.prototype.writeValue=function(t){t&&(this.value=t)},t.decorators=[{type:p.Component,args:[{selector:"ta-text",template:'<textarea\r\n  class="text-response w-100 px-2 py-1"\r\n  placeholder="Enter your response."\r\n  [ngModel]="value"\r\n  (ngModelChange)="onModelChange($event)"\r\n></textarea>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,providers:[{provide:s.NG_VALUE_ACCESSOR,useExisting:p.forwardRef(function(){return t}),multi:!0}],styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .text-response{height:120px;border:1px solid #c2c2c2;border-radius:4px;resize:none}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={question:[{type:p.Input}]},t}(),it=function(){function t(t,e){this.httpClient=t,this.veritasApiProxyPrefixUrl=e,this.url=this.veritasApiProxyPrefixUrl+"/question-survey"}return t.prototype.getQuestionContainerViewPages=function(t){return this.httpClient.get(this.url+"/"+t).pipe(l.map(this.mapGetQuestionContainerViewPages))},t.prototype.postAttachments$=function(t,e,n){var o=new FormData;return n.forEach(function(t){return o.append("attachmentFiles",t)}),this.httpClient.post(this.url+"/"+t+"/question/"+e+"/attachments",o,{reportProgress:!0,observe:"events"})},t.prototype.deleteAttachment$=function(t,e,n){return this.httpClient["delete"](this.url+"/"+t+"/question/"+e+"/attachments/"+n)},t.prototype.mapGetQuestionContainerViewPages=function(t){return t},t.prototype.postQuestionDetailResponses=function(t,e,n){var o={answers:t,submitAction:e};return this.httpClient.post("/api/question-survey/"+n,o)},t.decorators=[{type:p.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:i.HttpClient},{type:String,decorators:[{type:p.Inject,args:[R]}]}]},t.ngInjectableDef=p.defineInjectable({factory:function(){return new t(p.inject(i.HttpClient),p.inject("VERITAS_API_PROXY_PREFIX_URL"))},token:t,providedIn:"root"}),t}(),rt=function(){function t(){this.reviewMode=!1,this.viewMode=a.QuestionnaireViewModeEnum.All,this._viewModeSubject$=new o.Subject}return t.prototype.getReviewMode=function(){return this.reviewMode},t.prototype.setReviewMode=function(t){this.reviewMode=t},t.prototype.getViewMode=function(){return this.viewMode},t.prototype.changeViewMode=function(t){this.viewMode=t,this._viewModeSubject$.next(this.viewMode)},t.prototype.getViewModeObservable=function(){return this._viewModeSubject$.asObservable()},t.prototype.getQuestionAnswer=function(t){switch(t.questionDetailType){case a.QuestionTypeEnum.SingleSelect:var e=t.questionDetailResponses;if(e){var n=e.find(function(t){return t.questionDetailResponsesSelected});if(n)return n}break;case a.QuestionTypeEnum.Text:var o=t.questionDetailAnswerText;if(o)return o}return null},t.prototype.getConditionFulfilled=function(t,e){var n=e.questionDetailResponses.find(function(t){return t.questionDetailResponsesSelected});if(t.conditionDetails&&t.conditionDetails.conditionDetailConditions){for(var o=t.conditionDetails.conditionDetailConditions,i=0;i<o.length;i++){var r=o[i];if(!this.checkCondition(r,n))return!1}return!0}return!1},t.prototype.checkCondition=function(t,e){if(e&&t.expressionViewValueId&&e.questionDetailResponsesId===t.expressionViewValueId)return!0;return!1},t.decorators=[{type:p.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=p.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),st=function(){function t(t,e){this.formBuilder=t,this.questionnaireUtilsService=e,this.question={nodeId:null,nodeType:null,questionDetails:{questionDetailText:null,questionDetailType:null,commentMessageCount:null,questionDetailResponses:[],questionDetailAnswer:null,recordQuestionEntityId:null},children:[]},this.formReady=new p.EventEmitter,this.questionTypeEnum=a.QuestionTypeEnum,this.answerText="",this.questionForm=this.formBuilder.group({answer:null,questionId:null}),this.viewMode=this.questionnaireUtilsService.getViewMode()}return t.prototype.ngOnInit=function(){var e=this;this.processSelectedOption(),this.formReady.emit(this.questionForm),Object.keys(this.questionForm.controls).forEach(function(t){return e.questionForm.controls[t].valueChanges.subscribe(function(t){return e.formValueOfAnswerChanged(t)})}),this.questionnaireUtilsService.getViewModeObservable().subscribe(function(t){e.viewMode=t})},t.prototype.isQuestionVisible=function(){switch(this.viewMode){case a.QuestionnaireViewModeEnum.All:return!0;case a.QuestionnaireViewModeEnum.Answered:return this.question.isAnswered;case a.QuestionnaireViewModeEnum.Unanswered:return!this.question.isAnswered;default:return!0}},t.prototype.processSelectedOption=function(){this.questionForm.patchValue({questionId:this.question.nodeId,answerDescription:this.question.questionDetails.answerDescription},{emitEvent:!1});var t=this.questionnaireUtilsService.getQuestionAnswer(this.question.questionDetails);t&&(this.questionForm.patchValue({answer:t},{emitEvent:!1}),this.question.isAnswered=!0,this.questionAnswer=t)},t.prototype.formValueOfAnswerChanged=function(e){switch(this.question.questionDetails.questionDetailType){case a.QuestionTypeEnum.SingleSelect:var t=this.question.questionDetails.questionDetailResponses;if(t){var n=t.find(function(t){return t.questionDetailResponsesSelected});n&&(n.questionDetailResponsesSelected=!1),t.find(function(t){return t.questionDetailResponsesId===e.questionDetailResponsesId}).questionDetailResponsesSelected=!0}break;case a.QuestionTypeEnum.MultiSelect:if(this.question.questionDetails.questionDetailResponses){var o=this.question.questionDetails.questionDetailResponses.find(function(t){return t.questionDetailResponsesId===e.questionDetailResponsesId});o.questionDetailResponsesSelected=!o.questionDetailResponsesSelected}break;case a.QuestionTypeEnum.Text:this.question.questionDetails.questionDetailAnswerText=e}e&&e.answer?this.question.isAnswered=!0:this.question.isAnswered=!1},t.decorators=[{type:p.Component,args:[{selector:"ta-question",template:'<div class="question mb-3" [hidden]="!isQuestionVisible()">\r\n  <div class="d-flex">\r\n    <div\r\n      class="question-text mb-3 p-0 mr-auto"\r\n      [innerHTML]="question.questionDetails?.questionDetailText"\r\n    ></div>\r\n  </div>\r\n\r\n  <form\r\n    [ngSwitch]="question.questionDetails.questionDetailType"\r\n    [formGroup]="questionForm"\r\n  >\r\n    <ta-single-select\r\n      *ngSwitchCase="questionTypeEnum.SingleSelect"\r\n      formControlName="answer"\r\n      [question]="question"\r\n    ></ta-single-select>\r\n\r\n    <ta-multi-select\r\n      *ngSwitchCase="questionTypeEnum.MultiSelect"\r\n      formControlName="answer"\r\n      [question]="question"\r\n    ></ta-multi-select>\r\n\r\n    <ta-text\r\n      *ngSwitchCase="questionTypeEnum.Text"\r\n      formControlName="answer"\r\n      [question]="question"\r\n    ></ta-text>\r\n  </form>\r\n</div>\r\n',styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .question .question-text{display:inline-block;font-size:16px;color:#333;max-width:860px}:host .question .answer-description{height:120px;border:1px solid #c2c2c2;border-radius:4px;resize:none}:host .question .add-attachments-button{top:-1px;right:0}"]}]}],t.ctorParameters=function(){return[{type:s.FormBuilder},{type:rt}]},t.propDecorators={question:[{type:p.Input}],formReady:[{type:p.Output}]},t}(),at=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[st,et,nt,ot],imports:[u.CommonModule,d.TaRadioModule,s.ReactiveFormsModule,s.FormsModule,d.TaButtonsModule,d.TaSvgIconModule,d.TaDropdownModule,d.TaTooltipModule,Y,d.TaProgressbarModule],exports:[st]}]}],t}(),ct=function(){function t(){}return t.prototype.ngOnInit=function(){},t.decorators=[{type:p.Component,args:[{selector:"ta-question-more-menu",template:'<div taDropdown placement="bottom-right" autoClose="outside">\r\n  <a\r\n    class="dropdown-toggle"\r\n    taDropdownToggle\r\n    href="#"\r\n    role="button"\r\n    data-toggle="dropdown"\r\n    aria-haspopup="true"\r\n    aria-expanded="false"\r\n    (click)="$event.preventDefault()"\r\n  >\r\n    <ta-icon icon="more" color="#595959"></ta-icon>\r\n  </a>\r\n\r\n  <div taDropdownMenu></div>\r\n</div>\r\n',changeDetection:p.ChangeDetectionStrategy.OnPush,styles:[""]}]}],t.ctorParameters=function(){return[]},t}(),lt=function(){function t(t,e){this.formBuilder=t,this.questionnaireUtilsService=e,this.question={nodeId:null,nodeType:null,questionDetails:{questionDetailText:null,questionDetailType:null,commentMessageCount:null,questionDetailResponses:[],questionDetailAnswer:null,recordQuestionEntityId:null},children:[]},this.formReady=new p.EventEmitter,this.afterFilesSelected=new p.EventEmitter,this.deleteAttachment=new p.EventEmitter,this.clickAttachment=new p.EventEmitter,this.questionAccordionForm=this.formBuilder.group({question:null,children:this.formBuilder.array([]),conditionFulfilled:!1})}return Object.defineProperty(t.prototype,"children",{get:function(){return this.questionAccordionForm.get("children")},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var e=this;this.formReady.emit(this.questionAccordionForm),this.questionAccordionForm.valueChanges.subscribe(function(t){e.formValueChanged(t)}),this.reviewMode=this.questionnaireUtilsService.getReviewMode()},t.prototype.questionFormReady=function(t){this.questionAccordionForm.setControl("question",t)},t.prototype.childFormReady=function(t){this.children.push(t)},t.prototype.onAddAttachments=function(){this.simpleFileUploadComponent.fileUploadComponent.openUploadBrowser()},t.prototype.formValueChanged=function(t){for(var e=0;e<this.question.children.length;e++){var n=this.question.children[e];n.conditionFulfilled=this.questionnaireUtilsService.getConditionFulfilled(n,this.question.questionDetails),this.questionAccordionForm.patchValue({conditionFulfilled:n.conditionFulfilled},{emitEvent:!1})}},t.decorators=[{type:p.Component,args:[{selector:"ta-question-accordion",template:'<div class="question-accordion mb-3">\r\n  <div class="review-info" *ngIf="reviewMode; else editMode">\r\n    <table>\r\n      <tr>\r\n        <td>\r\n          Response\r\n        </td>\r\n        <td>\r\n          --\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          Comments\r\n        </td>\r\n        <td>\r\n          --\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          Attachments\r\n        </td>\r\n        <td>--</td>\r\n      </tr>\r\n    </table>\r\n  </div>\r\n\r\n  <ng-template #editMode>\r\n    <section class="col-8 pl-0 pr-3">\r\n      <ta-question\r\n        [question]="question"\r\n        (formReady)="questionFormReady($event)"\r\n      ></ta-question>\r\n\r\n      <ng-container\r\n        *ngTemplateOutlet="\r\n          childQuestions;\r\n          context: {\r\n            children: question.children\r\n          }\r\n        "\r\n      ></ng-container>\r\n\r\n      <ng-template #childQuestions let-children="children">\r\n        <ng-container *ngFor="let conditionTree of children">\r\n          <div [hidden]="!conditionTree.conditionFulfilled">\r\n            <ng-container *ngFor="let childQuestion of conditionTree.children">\r\n              <ta-question\r\n                class="d-block mt-4"\r\n                [question]="childQuestion"\r\n                (formReady)="childFormReady($event)"\r\n              ></ta-question>\r\n\r\n              <ng-container\r\n                *ngTemplateOutlet="\r\n                  childQuestions;\r\n                  context: {\r\n                    children: childQuestion.children\r\n                  }\r\n                "\r\n              ></ng-container>\r\n            </ng-container>\r\n          </div>\r\n        </ng-container>\r\n      </ng-template>\r\n    </section>\r\n\r\n    <div class="d-flex mt-3">\r\n      \x3c!-- todo : formControlName="answerDescription" --\x3e\r\n      \x3c!-- answerDescription: null --\x3e\r\n      <textarea\r\n        class="answer-description flex-fill px-2 py-1 mr-3 mb-1"\r\n        placeholder="Describe the policy, process, procedure, or mechanism that is in place. (Optional)"\r\n      ></textarea>\r\n\r\n      <div class="d-flex flex-column p-0 col-4">\r\n        <ta-progressbar\r\n          *ngIf="question.questionDetails?.fileContainer?.isLoading"\r\n          class="position-absolute w-100 p-1 mt-n4"\r\n          type="info"\r\n          [showValue]="true"\r\n          [value]="question.questionDetails?.fileContainer?.progress"\r\n        ></ta-progressbar>\r\n\r\n        <button\r\n          class="add-attachments-button position-absolute"\r\n          taButton\r\n          taType="circle"\r\n          (click)="onAddAttachments()"\r\n        >\r\n          <ta-icon icon="plus-circle"></ta-icon>\r\n        </button>\r\n\r\n        <ta-simple-file-upload\r\n          [id]="\'file-upload-question-\' + question?.nodeId"\r\n          [attachments]="question.questionDetails?.attachments"\r\n          [files]="question.questionDetails?.fileContainer?.files"\r\n          [uploadHidden]="true"\r\n          (afterFilesSelected)="afterFilesSelected.emit([question, $event])"\r\n          (clickAttachment)="clickAttachment.emit($event)"\r\n          (deleteAttachment)="deleteAttachment.emit([question, $event])"\r\n        ></ta-simple-file-upload>\r\n      </div>\r\n    </div>\r\n  </ng-template>\r\n\r\n  <div class="actions m-4">\r\n    <div class="d-flex">\r\n      <ta-comments-popover\r\n        [entityId]="question.questionDetails?.recordQuestionEntityId"\r\n      ></ta-comments-popover>\r\n\r\n      <ta-question-more-menu></ta-question-more-menu>\r\n\r\n      <ta-toggleswitch\r\n        *ngIf="reviewMode"\r\n        theme="secondary"\r\n        type="icon"\r\n        class="mt-1"\r\n      ></ta-toggleswitch>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .question-accordion{position:relative;border-radius:4px;border:1px solid #f3f3f3;background-color:#fff;padding:24px;box-shadow:2px 2px 4px 0 rgba(0,0,0,.05)}:host .question-accordion .actions{position:absolute;top:0;right:0}:host .question-accordion .review-info{width:80%}:host .question-accordion .review-info table{width:100%}:host .question-accordion .review-info table tr{border:1px solid #f3f3f3}:host .question-accordion .review-info table tr td{padding:12px 16px}:host .question-accordion .review-info table tr td:first-child{width:200px;font-weight:700}:host .question-accordion .answer-description{height:120px;border:1px solid #c2c2c2;border-radius:4px;resize:none}:host .question-accordion .add-attachments-button{top:-1px;right:0}"]}]}],t.ctorParameters=function(){return[{type:s.FormBuilder},{type:rt}]},t.propDecorators={question:[{type:p.Input}],formReady:[{type:p.Output}],afterFilesSelected:[{type:p.Output}],deleteAttachment:[{type:p.Output}],clickAttachment:[{type:p.Output}],simpleFileUploadComponent:[{type:p.ViewChild,args:[K]}]},t}(),ut=[d.TaRadioModule,d.TaProgressbarModule,d.TaSvgIconModule,d.TaButtonsModule,d.TaDropdownModule],pt=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[lt,ct],imports:b([u.CommonModule,s.ReactiveFormsModule,s.FormsModule,at,j,Y,d.TaToggleSwitchModule],ut),exports:[lt,ct]}]}],t}(),dt=function(){function t(){this.taskStatusEnum=a.TaskStatusEnum}return t.prototype.ngOnInit=function(){},t.decorators=[{type:p.Component,args:[{selector:"ta-task-status-tag",template:"<div\r\n  class=\"status-container text-truncate\"\r\n  [ngClass]=\"{\r\n    open: taskStatus === taskStatusEnum.Open,\r\n    'in-progress': taskStatus === taskStatusEnum.InProgress,\r\n    'in-review': taskStatus === taskStatusEnum.InReview,\r\n    closed: taskStatus === taskStatusEnum.Closed,\r\n    'action-required': taskStatus === taskStatusEnum.ActionRequired\r\n  }\"\r\n>\r\n  {{ taskStatusEnum.getDisplayText(taskStatus) }}\r\n</div>\r\n",changeDetection:p.ChangeDetectionStrategy.OnPush,styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host .status-container{padding:2px 12px;border-radius:12px;border:1px solid transparent}:host .status-container.open{background-color:#f1f1f1;border-color:#ddd;color:#595959}:host .status-container.in-progress{background-color:#e5edf9;border-color:#ccdcf4;color:#0052cc}:host .status-container.in-review{background-color:#efedf8;border-color:#e0dcf2;color:#3c3273}:host .status-container.closed{background-color:#f8fcf5;border-color:#dff3d3;color:#387515}:host .status-container.action-required{background-color:#fff6e5;border-color:#fec;color:#995400}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={taskStatus:[{type:p.Input}]},t}(),ht=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[dt],imports:[u.CommonModule],exports:[dt]}]}],t}(),mt=function(){function t(t,e,n,o,i,r,s){this.formBuilder=t,this.dashBoardSurveyControllerService=e,this.dashBoardCommentControllerService=n,this.questionnaireUtilsService=o,this.router=i,this.toastService=r,this.modal=s,this.questionnaireViewModesEnum=a.QuestionnaireViewModeEnum,this.taskStatusEnum=a.TaskStatusEnum,this.selectedSectionIndex=0,this.showActionStatus=!1,this.selectedViewMode=a.QuestionnaireViewModeEnum.All}return t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){this.unsubscribe()},t.prototype.ngOnChanges=function(i){return g(this,void 0,void 0,function(){var e,n,o=this;return y(this,function(t){switch(t.label){case 0:if(!w(i.recordId))return[3,5];if(!this.recordId)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this).dashBoardSurveyControllerService.getQuestionContainerViewPages(this.recordId).toPromise()];case 2:return e.questionnaire=t.sent(),this.questionnaire.questionContainerViewPages.forEach(function(t){return o.initDefaultFileContainerInQuestions(t.questionTree)}),this.sections=this.questionnaire.questionContainerViewPages,this.selectSection(this.sections[this.selectedSectionIndex],this.selectedSectionIndex),this.updateQuestionnaireCounts(),[3,4];case 3:return n=t.sent(),this.toastService.error(x("Questionnaire load failed",n)),[3,4];case 4:this.resetForm(),t.label=5;case 5:return w(i.reviewMode)&&this.questionnaireUtilsService.setReviewMode(this.reviewMode),[2]}})})},Object.defineProperty(t.prototype,"isSectionComplete",{get:function(){return!!this.selectedSection&&this.selectedSection.totalActiveAnswerCount===this.selectedSection.totalActiveQuestionCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFirstSection",{get:function(){return 0===this.selectedSectionIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLastSection",{get:function(){return this.selectedSectionIndex===this.sections.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionQuestions",{get:function(){return this.sectionForm.get("questions")},enumerable:!0,configurable:!0}),t.prototype.questionFormReady=function(t){this.sectionQuestions.push(t)},t.prototype.selectViewMode=function(t){this.selectedViewMode=t,this.questionnaireUtilsService.changeViewMode(t)},t.prototype.selectSection=function(t,e){this.resetForm(),this.selectedSectionIndex=e,this.selectedSection=t},t.prototype.selectNextSection=function(){this.selectedSectionIndex++,this.selectedSection=this.sections[this.selectedSectionIndex]},t.prototype.selectPrevSection=function(){this.selectedSectionIndex--,this.selectedSection=this.sections[this.selectedSectionIndex]},t.prototype.isSelectedSection=function(t){return t.id===this.selectedSection.id},t.prototype.submitQuestionnaire=function(){this.postQuestionnaire(this.sectionForm.value,!0)},t.prototype.exitQuestionnaire=function(){return g(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.router.navigateByUrl("tasks")];case 1:return t.sent(),[2]}})})},t.prototype.onAfterFilesSelected=function(t){var e=this;this.showActionStatus=!0;var n=t[0],o=t[1];this.setFileContainer(n,{isLoading:!0,progress:0}),this.dashBoardSurveyControllerService.postAttachments$(this.questionnaire.recordId,n.nodeId,o.map(function(t){return t.file})).subscribe(function(t){switch(t.type){case i.HttpEventType.UploadProgress:e.setFileContainer(n,{progress:C(t.loaded,t.total)});break;case i.HttpEventType.Response:e.showActionStatus=!1,e.setFileContainer(n,e.generateDefaultFileContainer()),e.setAttachments(n,t.body),e.toastService.success("Attachment uploaded")}},function(t){e.showActionStatus=!1,e.resetToDefaultFileContainer(n),e.toastService.error(x("File upload failed",t))})},t.prototype.onClickAttachment=function(t){var e=this;this.dashBoardCommentControllerService.getAttachmentDownloadUrl$(t.id).subscribe(function(t){return window.open(t)},function(t){return e.toastService.error(x("Attachment load failed",t))})},t.prototype.openDeleteModal=function(t){var e=this,n=this.modal.open(_,{size:"sm",backdrop:"static"}),o=n.componentInstance;o.title="Delete Attachment?",o.clickPrimary.subscribe(function(){n.close(),e.onDeleteAttachment(t)})},t.prototype.onDeleteAttachment=function(t){var e=this;this.showActionStatus=!0;var n=t[0],o=t[1];this.dashBoardSurveyControllerService.deleteAttachment$(this.questionnaire.recordId,n.nodeId,o.id).pipe(l.finalize(function(){e.showActionStatus=!1})).subscribe(function(t){e.setAttachments(n,n.questionDetails.attachments.filter(function(t){return t.id!==o.id})),e.toastService.success("Attachment deleted")},function(t){e.resetToDefaultFileContainer(n),e.toastService.error(x("Attachment delete failed",t))})},t.prototype.setFileContainer=function(t,e){t.questionDetails=f({},t.questionDetails,{fileContainer:f({},t.questionDetails.fileContainer,e)})},t.prototype.setAttachments=function(t,e){t.questionDetails.attachments=e},t.prototype.resetToDefaultFileContainer=function(t){this.setFileContainer(t,this.generateDefaultFileContainer())},t.prototype.generateDefaultFileContainer=function(){return{files:[],progress:0,isLoading:!1}},t.prototype.postQuestionnaire=function(t,e){var n=this;this.showActionStatus=!0;for(var o=[],i=0;i<t.questions.length;i++){var r=t.questions[i];o=o.concat(this.crawlAnswer(r))}this.dashBoardSurveyControllerService.postQuestionDetailResponses(o,e,this.recordId).pipe(l.finalize(function(){n.showActionStatus=!1})).subscribe(function(){return g(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?[4,this.exitQuestionnaire()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},t.prototype.crawlAnswer=function(t){var e=[],n=t.question.answer;if(n){var o={answerDetailText:n.questionDetailResponsesChoice,questionDetailResponsesIds:[n.questionDetailResponsesId],questionNodeId:t.question.questionId,answerDescription:t.question.answerDescription};e.push(o)}if(t.conditionFulfilled)for(var i=0;i<t.children.length;i++){var r=t.children[i];e=e.concat(this.crawlAnswer(r))}return e},t.prototype.updateQuestionnaireCounts=function(t){if(t)this.updateSectionCounts(this.selectedSection);else for(var e=0;e<this.sections.length;e++){var n=this.sections[e];this.updateSectionCounts(n)}this.updateTotalSectionCounts()},t.prototype.updateTotalSectionCounts=function(){for(var t=0,e=0,n=0;n<this.sections.length;n++){var o=this.sections[n];t+=o.totalActiveAnswerCount,e+=o.totalActiveQuestionCount}this.totalAnswersCount=t,this.totalQuestionsCount=e},t.prototype.updateSectionCounts=function(t){for(var e=t.questionTree,n=0,o=0,i=0;i<e.length;i++){var r=e[i],s=this.crawlQuestion(r);n+=s.questionTotal,o+=s.answerTotal}t.totalActiveQuestionCount=n,t.totalActiveAnswerCount=o},t.prototype.crawlQuestion=function(t){var e=0,n=0;if(0<t.children.length)for(var o=0;o<t.children.length;o++){var i=t.children[o];if(this.questionnaireUtilsService.getConditionFulfilled(i,t.questionDetails)){for(var r=0,s=0,a=0;a<i.children.length;a++){var c=i.children[a],l=this.crawlQuestion(c);r+=l.questionTotal,s+=l.answerTotal}e+=r,n+=s}}return e+=1,this.questionnaireUtilsService.getQuestionAnswer(t.questionDetails)&&(n+=1),{questionTotal:e,answerTotal:n}},t.prototype.resetForm=function(){var e=this;this.sectionForm=this.formBuilder.group({questions:this.formBuilder.array([])}),this.unsubscribe(),this._updateQuestionnaireCountsSubscription$=this.sectionForm.valueChanges.pipe(l.debounceTime(10)).subscribe(function(t){e.updateQuestionnaireCounts(!0)}),this._sectionFormSubscription$=this.sectionForm.valueChanges.pipe(l.debounceTime(1e3)).subscribe(function(t){e.postQuestionnaire(t,!1)})},t.prototype.unsubscribe=function(){this._updateQuestionnaireCountsSubscription$&&this._updateQuestionnaireCountsSubscription$.unsubscribe(),this._sectionFormSubscription$&&this._sectionFormSubscription$.unsubscribe()},t.prototype.initDefaultFileContainerInQuestions=function(t){var e=this;t.forEach(function(t){t.questionDetails.fileContainer=e.generateDefaultFileContainer(),t.children.forEach(function(t){e.initDefaultFileContainerInQuestions(t.children)})})},t.decorators=[{type:p.Component,args:[{selector:"ta-questionnaire-content",template:'<div\r\n  class="fadeInApp d-flex flex-column questionnaire h-100"\r\n  *ngIf="questionnaire"\r\n>\r\n  <div class="questionnaire-header">\r\n    <div class="title-container">\r\n      <h2 class="title">{{ questionnaire.recordName }}</h2>\r\n      <div class="action-status" [hidden]="!showActionStatus">Saving...</div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="tab-content flex-grow-1">\r\n    <div class="questionnaire-content h-100 d-flex">\r\n      <div class="section-selector flex-shrink-0">\r\n        <div class="d-flex align-items-start flex-column">\r\n          <div class="total-questions">\r\n            Questions ({{ totalAnswersCount }}/{{ totalQuestionsCount }})\r\n          </div>\r\n          <ul>\r\n            <li\r\n              *ngFor="let section of sections; let sectionIndex = index"\r\n              class="section"\r\n              [ngClass]="{\r\n                active: isSelectedSection(section),\r\n                answered:\r\n                  section.totalActiveAnswerCount ===\r\n                  section.totalActiveQuestionCount\r\n              }"\r\n              (click)="selectSection(section, sectionIndex)"\r\n            >\r\n              <span *ngIf="section.frameworkStandard"\r\n                >{{ section.frameworkStandard.name }} ({{\r\n                  section.totalActiveAnswerCount\r\n                }}/{{ section.totalActiveQuestionCount }})</span\r\n              >\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <div class="section-content flex-grow-1">\r\n        <ng-container *ngIf="selectedSection">\r\n          <h3 class="mt-2 mb-4 d-inline-block">\r\n            {{ selectedSection.frameworkStandard?.name }} ({{\r\n              selectedSection.totalActiveAnswerCount\r\n            }}/{{ selectedSection.totalActiveQuestionCount }})\r\n          </h3>\r\n          <div\r\n            *ngIf="!reviewMode"\r\n            taDropdown\r\n            class="d-inline-block float-right"\r\n            placement="bottom-right"\r\n          >\r\n            <button\r\n              taType="dropdown"\r\n              type="button"\r\n              taButton\r\n              id="dropdownBasic1"\r\n              taDropdownToggle\r\n              [ngSwitch]="selectedViewMode"\r\n            >\r\n              <span *ngSwitchCase="questionnaireViewModesEnum.All">\r\n                All Questions ({{ selectedSection.totalActiveQuestionCount }})\r\n              </span>\r\n              <span *ngSwitchCase="questionnaireViewModesEnum.Unanswered">\r\n                Unanswered ({{\r\n                  selectedSection.totalActiveQuestionCount -\r\n                    selectedSection.totalActiveAnswerCount\r\n                }})\r\n              </span>\r\n              <span *ngSwitchCase="questionnaireViewModesEnum.Answered">\r\n                Answered ({{ selectedSection.totalActiveAnswerCount }})\r\n              </span>\r\n            </button>\r\n            <div taDropdownMenu aria-labelledby="dropdownBasic1">\r\n              <button\r\n                class="dropdown-item"\r\n                (click)="selectViewMode(questionnaireViewModesEnum.All)"\r\n              >\r\n                All Questions ({{ selectedSection.totalActiveQuestionCount }})\r\n              </button>\r\n              <button\r\n                class="dropdown-item"\r\n                (click)="selectViewMode(questionnaireViewModesEnum.Unanswered)"\r\n              >\r\n                Unanswered ({{\r\n                  selectedSection.totalActiveQuestionCount -\r\n                    selectedSection.totalActiveAnswerCount\r\n                }})\r\n              </button>\r\n              <button\r\n                class="dropdown-item"\r\n                (click)="selectViewMode(questionnaireViewModesEnum.Answered)"\r\n              >\r\n                Answered ({{ selectedSection.totalActiveAnswerCount }})\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <p class="introduction mb-4">\r\n            {{ selectedSection.introductionMessage }}\r\n          </p>\r\n          <ng-container *ngFor="let question of selectedSection.questionTree">\r\n            <ta-question-accordion\r\n              [question]="question"\r\n              (formReady)="questionFormReady($event)"\r\n              (afterFilesSelected)="onAfterFilesSelected($event)"\r\n              (clickAttachment)="onClickAttachment($event)"\r\n              (deleteAttachment)="openDeleteModal($event)"\r\n            >\r\n            </ta-question-accordion>\r\n          </ng-container>\r\n        </ng-container>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="navigator">\r\n    <button taButton taType="flat" (click)="exitQuestionnaire()">\r\n      Exit\r\n    </button>\r\n    <div class="float-right">\r\n      <button\r\n        taButton\r\n        taType="secondary"\r\n        class="mr-2"\r\n        (click)="selectPrevSection()"\r\n        [disabled]="isFirstSection"\r\n      >\r\n        Back\r\n      </button>\r\n      <button\r\n        *ngIf="!isLastSection"\r\n        taButton\r\n        taType="primary"\r\n        [disabled]="!isSectionComplete"\r\n        (click)="selectNextSection()"\r\n      >\r\n        Next\r\n      </button>\r\n      <button\r\n        *ngIf="isLastSection"\r\n        taButton\r\n        taType="primary"\r\n        [disabled]="!isSectionComplete"\r\n        (click)="submitQuestionnaire()"\r\n      >\r\n        {{ reviewMode ? \'Finish Review\' : \'Submit\' }}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}:host{display:block;height:calc(100vh - 72px)}:host h2{font-size:20px;font-weight:600}:host h3{font-size:16px;font-weight:600}:host h4{font-size:12px;font-weight:600}:host p{font-size:12px}:host small{font-size:11px;color:#777}:host .box{padding:24px;border:1px solid #f3f3f3;border-radius:4px;background-color:#fff}:host .header-content ta-initial-indicator{margin-right:-4px;cursor:default}:host .header-content ta-initial-indicator:last-child{margin-right:0}:host .tab-content{overflow:auto}:host .questionnaire-introduction{padding:24px;background-color:#fcfcfc}:host .tabs{position:relative}:host .tabs .action-status{position:absolute;top:0;left:280px;line-height:37px;color:#595959}:host .questionnaire-header{background-color:#fff;z-index:1;box-shadow:0 2px 4px 0 rgba(0,0,0,.05)}:host .questionnaire-header .title-container{margin-left:24px;margin-bottom:20px}:host .questionnaire-header .title-container h2{display:inline-block}:host .questionnaire-header .title-container .action-status{margin-left:16px;color:#595959;display:inline-block}:host .questionnaire-content .section-content{overflow:auto;background-color:#fcfcfc;padding:24px}:host .questionnaire-content .section-content .introduction{font-size:16px}:host .navigator{padding:12px 20px;border-top:1px solid #f3f3f3;background-color:#fff}:host .section-selector{overflow:auto;background-color:#fff;box-shadow:2px 2px 4px 0 rgba(0,0,0,.05);z-index:2;width:300px;padding:0 24px 24px}:host .section-selector .total-questions{font-weight:600;margin-bottom:16px}:host .section-selector ul{padding-left:14px;margin:0}:host .section-selector li{cursor:pointer;list-style:none;position:relative;padding-left:8px;margin-bottom:12px}:host .section-selector li:before{content:'';display:inline-block;position:absolute;left:-14px;top:4px;height:14px;width:14px;background-image:url(/assets/images/question-check-unanswered.svg);background-size:contain;background-repeat:no-repeat}:host .section-selector li.active span{font-weight:600;color:#004575}:host .section-selector li.answered:before{background-image:url(/assets/images/question-check-answered.svg)}"]}]}],t.ctorParameters=function(){return[{type:s.FormBuilder},{type:it},{type:U},{type:rt},{type:c.Router},{type:d.ToastService},{type:d.TaModal}]},t.propDecorators={recordId:[{type:p.Input}],reviewMode:[{type:p.Input}]},t}(),ft=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[mt],imports:[u.CommonModule,at,pt,s.FormsModule,s.ReactiveFormsModule,d.TaButtonsModule,d.TaTabsetModule,d.TaDropdownModule,d.TaTagsModule,ht,A,d.TaTooltipModule,z],exports:[mt]}]}],t}(),gt=function(){function t(t){this.modalService=t}return t.prototype.ngOnInit=function(){},t.decorators=[{type:p.Component,args:[{selector:"ta-questionnaire-content-modal",template:'<div\r\n  class="modal-body d-flex flex-column align-items-center justify-content-center"\r\n>\r\n  <ta-questionnaire-content\r\n    [recordId]="recordId"\r\n    [reviewMode]="reviewMode"\r\n  ></ta-questionnaire-content>\r\n</div>\r\n\r\n<div class="modal-footer align-items-start justify-content-start p-4">\r\n  <button\r\n    taButton\r\n    taType="flat"\r\n    class="cancel-button mr-auto btn-lg"\r\n    data-dismiss="modal"\r\n    (click)="modalService.dismiss(\'Cancel click\')"\r\n  >\r\n    Cancel\r\n  </button>\r\n</div>\r\n',encapsulation:p.ViewEncapsulation.None,changeDetection:p.ChangeDetectionStrategy.OnPush,styles:[".card{box-shadow:0 1px 4px 0 rgba(0,0,0,.15)}.card .card-header{font-size:.875rem}button,input,textarea{outline:0!important;box-shadow:none!important}strong{font-weight:500}input::-ms-clear{display:none;width:0;height:0}input::-ms-reveal{display:none;width:0;height:0}input::-webkit-search-cancel-button,input::-webkit-search-decoration,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none}ta-questionnaire-content-modal .modal-footer{border-top:none!important}ta-questionnaire-content-modal .modal-footer .secondary-button{color:#000}"]}]}],t.ctorParameters=function(){return[{type:d.TaActiveModal}]},t.propDecorators={recordId:[{type:p.Input}],reviewMode:[{type:p.Input}]},t}(),yt=function(){function t(){}return t.decorators=[{type:p.NgModule,args:[{declarations:[gt],imports:[u.CommonModule,d.TaButtonsModule,d.TaSvgIconModule,d.TaModalModule,ft],exports:[gt],entryComponents:[gt]}]}],t}(),vt=function Dt(){},bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e}(vt),xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e}(vt),wt=function Ft(){},Ct=function Et(){};a.CommentsPopoverModule=j,a.CommentsPopoverComponent=Q,a.CommentFormComponent=B,a.DeleteModalModule=z,a.DeleteModalComponent=_,a.FileDownloadModule=$,a.FileDownloadComponent=N,a.FileUploadComponent=G,a.FileUploadModule=X,a.FORMAT=H,a.FileUploadValidationService=W,a.SimpleFileUploadComponent=K,a.SimpleFileUploadModule=Y,a.SimpleFileUploadItem=J,a.SimpleFileUploadConfig=Z,a.SimpleFileUploadItemContainer=tt,a.InitialIndicatorModule=A,a.InitialIndicatorComponent=M,a.QuestionModule=at,a.QuestionComponent=st,a.MultiSelectComponent=et,a.SingleSelectComponent=nt,a.TextComponent=ot,a.QuestionAccordionModule=pt,a.QuestionAccordionComponent=lt,a.QuestionMoreMenuComponent=ct,a.TaskStatusTagModule=ht,a.TaskStatusTagComponent=dt,a.QuestionnaireContentModule=ft,a.QuestionnaireContentComponent=mt,a.QuestionnaireContentModalModule=yt,a.QuestionnaireContentModalComponent=gt,a.PAGE_OFFSET_FOR_SERVER=-1,a.SEARCH_DEBOUNCE_TIME=300,a.VERITAS_API_PROXY_PREFIX_URL=R,a.CommentBase=vt,a.Comment=bt,a.CommentReply=xt,a.Assignee=wt,a.Attachment=Ct,a.AaaUserService=V,a.DashBoardCommentControllerService=U,a.DashBoardSurveyControllerService=it,a.QuestionnaireUtilsService=rt,a.UserControllerService=P,a.ChangeDetectableComponentBase=L,a.CustomEncoder=O,a.stringContains=function Mt(t,e){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},a.generateErrorMessage=x,a.onlyUnique=function At(e,t,n){return t===n.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)})},a.nameOf=function(t){return t},a.flatMap=function Rt(t,e){var n;return(n=[]).concat.apply(n,b(t.map(function(t){return t[e]})))},a.getZoneOffset=function Ot(){for(var t=(new Date).getTimezoneOffset(),e=t<0,n=(t*(e?-1:1)).toString(),o=n.toString().length;o<4;o++)n="0"+n;return e?"-":"+"+n},a.getEnumKeys=function Pt(t){return Object.keys(t).filter(function(t){return isNaN(t)&&"values"!==t})},a.isPropertyChanged=w,a.omitDeep=function Bt(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var o=r.cloneDeep(t);return r.cloneDeepWith(o,function i(e){e&&"object"==typeof e&&n.forEach(function(t){delete e[t]})})},a.getProgress=C,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=veritas-ui-library.umd.min.js.map